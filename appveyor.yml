version: 1.0.{build}
image: Ubuntu1804
environment:
  TWEEGO_VERSION: 1.3.0
  STORY_FORMATS_VERSION: 20180826

install:
- sh: >-
    sudo apt-get install -yq megatools

    wget http://www.motoslave.net/tweego/download.php/tweego-${TWEEGO_VERSION}-linux-x64.zip

    wget http://www.motoslave.net/tweego/download.php/story-formats-${STORY_FORMATS_VERSION}.zip

    unzip -nq tweego-${TWEEGO_VERSION}-linux-x64.zip && rm tweego-${TWEEGO_VERSION}-linux-x64.zip

    unzip -nq story-formats-${STORY_FORMATS_VERSION}.zip && rm story-formats-${STORY_FORMATS_VERSION}.zip

    chmod +x ./tweego
build_script:
- sh: >-
    ./tweego -f sugarcube-2 -o Queen.html src

    scripts/publish.sh "$APPVEYOR_REPO_BRANCH" "$APPVEYOR_REPO_TAG_NAME"
